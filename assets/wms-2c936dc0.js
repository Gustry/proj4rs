import{g as l,D as g}from"./Image-dc01ef9b.js";import{bV as S,g as L,a as P,b as f,d as m,bW as M,O,o as R}from"./proj4-75e1e0c4.js";function T(e,n){const r=[];Object.keys(n).forEach(function(s){n[s]!==null&&n[s]!==void 0&&r.push(s+"="+encodeURIComponent(n[s]))});const t=r.join("&");return e=e.replace(/[?&]$/,""),e+=e.includes("?")?"&":"?",e+t}const o="1.3.0",I=[101,101];function A(e,n,r,t,s){s.WIDTH=r[0],s.HEIGHT=r[1];const c=t.getAxisOrientation();let i;const a=R(s.VERSION,"1.3")>=0;return s[a?"CRS":"SRS"]=t.getCode(),a&&c.substr(0,2)=="ne"?i=[n[1],n[0],n[3],n[2]]:i=n,s.BBOX=i.join(","),T(e,s)}function j(e,n,r,t,s,c,i){c=Object.assign({REQUEST:"GetMap"},c);const a=n/r,d=[S(L(e)/a,g),S(P(e)/a,g)];if(r!=1)switch(i){case"geoserver":const u=90*r+.5|0;"FORMAT_OPTIONS"in c?c.FORMAT_OPTIONS+=";dpi:"+u:c.FORMAT_OPTIONS="dpi:"+u;break;case"mapserver":c.MAP_RESOLUTION=90*r;break;case"carmentaserver":case"qgis":c.DPI=90*r;break;default:throw new Error("Unknown `serverType` configured")}return A(s,e,d,t,c)}function b(e,n){return Object.assign({REQUEST:n,SERVICE:"WMS",VERSION:o,FORMAT:"image/png",STYLES:"",TRANSPARENT:!0},e)}function U(e){const n=e.hidpi===void 0?!0:e.hidpi,r=f(e.projection||"EPSG:3857"),t=e.ratio||1.5,s=e.load||m;return(c,i,a)=>{c=l(c,i,a,t),a!=1&&(!n||e.serverType===void 0)&&(a=1);const d=j(c,i,a,r,e.url,b(e.params,"GetMap"),e.serverType),E=new Image;return e.crossOrigin!==null&&(E.crossOrigin=e.crossOrigin),s(E,d).then(u=>({image:u,extent:c,pixelRatio:a}))}}function h(e,n,r){if(e.url===void 0)return;const t=f(e.projection||"EPSG:3857"),s=M(n,r,0,I),c={QUERY_LAYERS:e.params.LAYERS,INFO_FORMAT:"application/json"};Object.assign(c,b(e.params,"GetFeatureInfo"),e.params);const i=O((n[0]-s[0])/r,g),a=O((s[3]-n[1])/r,g),d=R(c.VERSION,"1.3")>=0;return c[d?"I":"X"]=i,c[d?"J":"Y"]=a,A(e.url,s,I,t,c)}function y(e,n){if(e.url===void 0)return;const r={SERVICE:"WMS",VERSION:o,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(e.params===void 0||e.params.LAYER===void 0){const t=e.params.LAYERS;if(!(!Array.isArray(t)||t.length===1))return;r.LAYER=t}if(n!==void 0){const t=f(e.projection||"EPSG:3857").getMetersPerUnit()||1,s=28e-5;r.SCALE=n*t/s}return Object.assign(r,e.params),T(e.url,r)}export{o as D,T as a,j as b,h as c,y as d,U as e,b as g};
//# sourceMappingURL=wms-2c936dc0.js.map
