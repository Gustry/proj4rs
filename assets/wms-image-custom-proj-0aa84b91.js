import{b as I,t as j,d as P,bQ as U,bR as W,bS as w,Q as F,p as E,r as k,bP as B,M as R,bT as N,V as O,bU as C}from"./proj4-75e1e0c4.js";/* empty css           */import{I as L}from"./Image-df45c9f2.js";import{I as $,d as A,c as V}from"./Image-dc01ef9b.js";import{c as D,d as G,e as H}from"./wms-2c936dc0.js";class Q extends ${constructor(e){e=e||{},super({attributions:e.attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null,this.url_=e.url,this.imageLoadFunction_=e.imageLoadFunction!==void 0?e.imageLoadFunction:A,this.params_=e.params,this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.renderedRevision_=0,this.ratio_=e.ratio!==void 0?e.ratio:1.5,this.loaderProjection_=null}getFeatureInfoUrl(e,s,n,r){const a=I(n),t=this.getProjection();t&&t!==a&&(s=V(t,a,e,s),e=j(e,a,t));const h={url:this.url_,params:{...this.params_,...r},projection:t||a};return D(h,e,s)}getLegendUrl(e,s){return G({url:this.url_,params:{...this.params_,...s}},e)}getParams(){return this.params_}getImageInternal(e,s,n,r){return this.url_===void 0?null:((!this.loader||this.loaderProjection_!==r)&&(this.loaderProjection_=r,this.loader=H({crossOrigin:this.crossOrigin_,params:this.params_,projection:r,serverType:this.serverType_,hidpi:this.hidpi_,url:this.url_,ratio:this.ratio_,load:(a,t)=>(this.image.setImage(a),this.imageLoadFunction_(this.image,t),P(a))})),super.getImageInternal(e,s,n,r))}getImageLoadFunction(){return this.imageLoadFunction_}getUrl(){return this.url_}setImageLoadFunction(e){this.imageLoadFunction_=e,this.changed()}setUrl(e){e!=this.url_&&(this.url_=e,this.loader=null,this.changed())}updateParams(e){Object.assign(this.params_,e),this.changed()}changed(){this.image=null,super.changed()}}const y=Q,f="units",Y=[1,2,5],g=25.4/.28;class z extends U{constructor(e){e=e||{};const s=document.createElement("div");s.style.pointerEvents="none",super({element:s,render:e.render,target:e.target}),this.on,this.once,this.un;const n=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=n+"-inner",this.element.className=n+" "+W,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(f,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(f)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(f,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const s=e.center,n=e.projection,r=this.getUnits(),a=r=="degrees"?"degrees":"m";let t=w(n,e.resolution,s,a);const h=this.minWidth_*(this.dpi_||g)/g,d=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||g)/g:void 0;let l=h*t,i="";if(r=="degrees"){const _=F.degrees;l*=_,l<_/60?(i="″",t*=3600):l<_?(i="′",t*=60):i="°"}else if(r=="imperial")l<.9144?(i="in",t/=.0254):l<1609.344?(i="ft",t/=.3048):(i="mi",t/=1609.344);else if(r=="nautical")t/=1852,i="NM";else if(r=="metric")l<.001?(i="μm",t*=1e6):l<1?(i="mm",t*=1e3):l<1e3?i="m":(i="km",t/=1e3);else if(r=="us")l<.9144?(i="in",t*=39.37):l<1609.344?(i="ft",t/=.30480061):(i="mi",t/=1609.3472);else throw new Error("Invalid units");let m=3*Math.floor(Math.log(h*t)/Math.log(10)),c,o,u,v,b,x;for(;;){u=Math.floor(m/3);const _=Math.pow(10,u);if(c=Y[(m%3+3)%3]*_,o=Math.round(c/t),isNaN(o)){this.element.style.display="none",this.renderedVisible_=!1;return}if(d!==void 0&&o>=d){c=v,o=b,u=x;break}else if(o>=h)break;v=c,b=o,x=u,++m}const p=this.scaleBar_?this.createScaleBar(o,c,i):c.toFixed(u<0?-u:0)+" "+i;this.renderedHTML_!=p&&(this.innerElement_.innerHTML=p,this.renderedHTML_=p),this.renderedWidth_!=o&&(this.innerElement_.style.width=o+"px",this.renderedWidth_=o),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,s,n){const r=this.getScaleForResolution(),a=r<1?Math.round(1/r).toLocaleString()+" : 1":"1 : "+Math.round(r).toLocaleString(),t=this.scaleBarSteps_,h=e/t,d=[this.createMarker("absolute")];for(let i=0;i<t;++i){const m=i%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";d.push(`<div><div class="ol-scale-singlebar ${m}" style="width: ${h}px;"></div>`+this.createMarker("relative")+(i%2===0||t===2?this.createStepText(i,e,!1,s,n):"")+"</div>")}return d.push(this.createStepText(t,e,!0,s,n)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+a+"</div>":"")+d.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,s,n,r,a){const h=(e===0?0:Math.round(r/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+a),d=e===0?-3:s/this.scaleBarSteps_*-1,l=e===0?0:s/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${d}px;text-align: ${e===0?"left":"center"};min-width: ${l}px;left: ${n?s+"px":"unset"};">`+h+"</div>"}getScaleForResolution(){const e=w(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),s=this.dpi_||g,n=1e3/25.4;return e*n*s}render(e){const s=e.frameState;s?this.viewState_=s.viewState:this.viewState_=null,this.updateElement_()}}const q=z;E.defs("EPSG:21781","+proj=somerc +lat_0=46.95240555555556 +lon_0=7.439583333333333 +k_0=1 +x_0=600000 +y_0=200000 +ellps=bessel +towgs84=660.077,13.551,369.344,2.484,1.783,2.939,5.66 +units=m +no_defs");k(E);const T=new B({code:"EPSG:21781",extent:[485869.5728,76443.1884,837076.5648,299941.7864]}),S=[42e4,3e4,9e5,35e4],J=[new L({extent:S,source:new y({url:"https://wms.geo.admin.ch/",crossOrigin:"anonymous",attributions:'© <a href="https://shop.swisstopo.admin.ch/en/products/maps/national/lk1000"target="_blank">Pixelmap 1:1000000 / geo.admin.ch</a>',params:{LAYERS:"ch.swisstopo.pixelkarte-farbe-pk1000.noscale",FORMAT:"image/jpeg"},serverType:"mapserver"})}),new L({extent:S,source:new y({url:"https://wms.geo.admin.ch/",crossOrigin:"anonymous",attributions:'© <a href="https://www.hydrodaten.admin.ch/en/notes-on-the-flood-alert-maps.html"target="_blank">Flood Alert / geo.admin.ch</a>',params:{LAYERS:"ch.bafu.hydroweb-warnkarte_national"},serverType:"mapserver"})})];new R({controls:N().extend([new q]),layers:J,target:"map",view:new O({projection:T,center:C([8.23,46.86],T),extent:S,zoom:2})});
//# sourceMappingURL=wms-image-custom-proj-0aa84b91.js.map
